{"title":"Lesson 12: Interactions, Part 2","markdown":{"yaml":{"title":"Lesson 12: Interactions, Part 2","author":"Nicky Wakim","title-slide-attributes":{"data-background-color":"#213c96"},"date":"02/19/2025","format":{"revealjs":{"theme":"../simple_NW.scss","chalkboard":true,"slide-number":true,"show-slide-number":"all","width":1955,"height":1100,"footer":"Lesson 12: Interactions 2","highlight-style":"ayu","html-math-method":"mathjax"}},"execute":{"freeze":"auto"}},"headingText":"new packages","containsRefs":false,"markdown":"\n\n```{r}\n#| label: \"setup\" \n#| include: false\n#| message: false\n#| warning: false\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(knitr)\nlibrary(broom)\nlibrary(rstatix)\nlibrary(gt)\nlibrary(readxl)\n#----------\n# install.packages(\"describedata\")\nlibrary(describedata) # gladder()\nlibrary(gridExtra)   # grid.arrange()\nlibrary(ggfortify)  # autoplot(model)\n# New Day 6\nlibrary(gtsummary)\n\n# New Day 7\nlibrary(plotly) # for plot_ly() command\nlibrary(GGally) # for ggpairs() command \nlibrary(ggiraphExtra)   # for ggPredict() command\n\n# Load the data - update code if the csv file is not in the same location on your computer\n# If you need to download the file, please go to ur shared folder under Data > Slides\ngapm <- read_excel(\"data/Gapminder_vars_2011.xlsx\", \n                   na = \"NA\")  # important!!!! \n\n\ngapm_sub <- gapm %>% # called it gapm2_sub3 to be consistent with Day 7 notes\n  drop_na(LifeExpectancyYrs, FemaleLiteracyRate, four_regions, FoodSupplykcPPD) %>%\n  mutate(four_regions = factor(four_regions, \n                               levels = c(\"africa\", \"americas\", \n                                          \"asia\", \"europe\"), \n                               labels = c(\"Africa\", \"Americas\", \n                                          \"Asia\", \"Europe\"))) %>%\n  rename(income_levels = `World bank, 4 income groups 2017`) %>%\n  mutate(income_levels1 = factor(income_levels, \n                                levels = c(\"Low income\", \n                                           \"Lower middle income\", \n                                           \"Upper middle income\", \n                                           \"High income\")), \n         income_levels2 = relevel(factor(income_levels, \n                                levels = c(\"Low income\", \n                                           \"Lower middle income\", \n                                           \"Upper middle income\", \n                                           \"High income\"), \n                                labels = c(\"Lower income\", \"Lower income\", \n                                            \"Higher income\", \"Higher income\")), \n                                ref = \"Lower income\"))\n\n```\n\n# Learning Objectives\n\n**Last time:**\n\n1.  Define confounders and effect modifiers, and how they interact with the main relationship we model.\n2.  Interpret the interaction component of a model with **a binary categorical covariate and continuous covariate**, and how the main variable's effect changes.\n3.  Interpret the interaction component of a model with **a multi-level categorical covariate and continuous covariate**, and how the main variable's effect changes.\n\n**This time:**\n\n4.  Interpret the interaction component of a model with **two categorical covariates**, and how the main variable's effect changes.\n5.  Interpret the interaction component of a model with **two continuous covariates**, and how the main variable's effect changes.\n6. Report results for a best-fit line (with confidence intervals) at different levels of an effect measure modifier\n\n# Learning Objectives\n\n**Last time:**\n\n1.  Define confounders and effect modifiers, and how they interact with the main relationship we model.\n2.  Interpret the interaction component of a model with **a binary categorical covariate and continuous covariate**, and how the main variable's effect changes.\n3.  Interpret the interaction component of a model with **a multi-level categorical covariate and continuous covariate**, and how the main variable's effect changes.\n\n**This time:**\n\n::: lob\n4.  Interpret the interaction component of a model with **two categorical covariates**, and how the main variable's effect changes.\n:::\n\n5.  Interpret the interaction component of a model with **two continuous covariates**, and how the main variable's effect changes.\n\n## Do we think income level can be an effect modifier for world region?\n\n::: columns\n::: column\n-   Taking a break from female literacy rate to demonstrate interactions for two categorical variables\n\n-   We can start by visualizing the relationship between life expectancy and world region *by income level*\n\n-   Questions of interest: Does the effect of world region on life expectancy differ depending on income level?\n\n    -   This is the same as: Is income level an effect modifier for world region?\n\n-   Let's run an interaction model to see!\n:::\n\n::: column\n```{r fig.height=7, fig.width=9, warning=F, fig.align='center'}\n#| echo: false\nggplot(gapm_sub, aes(x = four_regions, y = LifeExpectancyYrs, \n                  color = income_levels2)) +\n  geom_jitter(size = 2, alpha = .6, width = 0.2) +\n  stat_summary(fun = mean, geom = \"point\", size = 8, shape = 18) +\n  labs(x = \"World Regions\", \n       y = \"Life expectancy (years)\",\n       title = \"Life expectancy vs. World Region\", \n       color = \"Income level\") +\n  theme(axis.title = element_text(size = 20), \n        axis.text = element_text(size = 20), \n        title = element_text(size = 20), \n        legend.text=element_text(size= 18)) +\n  scale_color_manual(values=c(\"#FF8021\", \"#34AC8B\"))\n```\n:::\n:::\n\n## Model with interaction between a *multi-level categorical and binary variables*\n\nModel we are fitting:\n\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\beta_3 I(\\text{Asia}) + \\beta_4 I(\\text{Europe}) + \\\\ & \\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe})+ \\epsilon \\end{aligned}$$\n\n-   $LE$ as life expectancy\n-   $I(\\text{high income})$ as indicator of high income\n-   $I(\\text{Americas})$, $I(\\text{Asia})$, $I(\\text{Europe})$ as the indicator for each world region\n\nIn R:\n\n```{r}\n#| echo: true\n# gapm_sub = gapm_sub %>% mutate(income_levels2 = relevel(income_levels2, ref = \"Higher income\")) # for poll everywhere\n\nm_int_wr_inc = lm(LifeExpectancyYrs ~ income_levels2 + four_regions +\n                  income_levels2*four_regions, data = gapm_sub)\nm_int_wr_inc = lm(LifeExpectancyYrs ~ income_levels2*four_regions, \n                data = gapm_sub)\n```\n\n## Displaying the regression table and writing fitted regression equation\n\n```{r}\n#| echo: true\n\ntidy(m_int_wr_inc, conf.int=T) %>% gt() %>% tab_options(table.font.size = 25) %>% fmt_number(decimals = 3)\n```\n\n$$\\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & 60.85 + 2.10 \\cdot I(\\text{high income}) + 10.8 \\cdot I(\\text{Americas}) + 7.47\\cdot  I(\\text{Asia}) + 11.50 \\cdot I(\\text{Europe}) + \\\\ & 2.64 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + 1.54 \\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & 2.38 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n## Poll Everywhere Question 4\n\n::: columns\n::: {.column width=\"60%\"}\n:::\n\n::: {.column width=\"40%\"}\n```{r fig.height=8, fig.width=8, warning=F, fig.align='center'}\n#| echo: false\nggplot(gapm_sub, aes(x = four_regions, y = LifeExpectancyYrs, \n                  color = income_levels2)) +\n  geom_jitter(size = 2, alpha = .6, width = 0.2) +\n  stat_summary(fun = mean, geom = \"point\", size = 8, shape = 18) +\n  labs(x = \"World Regions\", \n       y = \"Life expectancy (years)\",\n       title = \"Life expectancy vs. World Region\", \n       color = \"Income level\") +\n  theme(axis.title = element_text(size = 20), \n        axis.text = element_text(size = 20), \n        title = element_text(size = 20), \n        legend.text=element_text(size= 18), legend.position = \"bottom\") +\n  scale_color_manual(values=c(\"#FF8021\", \"#34AC8B\"))\n```\n:::\n:::\n\n\n## Comparing fitted regression *means* for each world region {.smaller}\n\n$$\\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & 60.85 + 2.10 \\cdot I(\\text{high income}) + 10.8 \\cdot I(\\text{Americas}) + 7.47\\cdot  I(\\text{Asia}) + 11.50 \\cdot I(\\text{Europe}) + \\\\ & 2.64 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + 1.54 \\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & 2.38 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n::: columns\n::: {.column width=\"25%\"}\n::: proof1\n::: proof-title\nAfrica\n:::\n\n::: proof-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 \\cdot 0 + \\widehat\\beta_4 \\cdot 0 + \\\\ & \\widehat\\beta_5 I(\\text{high income}) \\cdot 0 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 0+ \\\\& \\widehat\\beta_7 I(\\text{high income}) \\cdot 0 \\\\\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income})\\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"25%\"}\n::: fact\n::: fact-title\nThe Americas\n:::\n\n::: fact-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 1 + \\widehat\\beta_3 \\cdot 0 + \\widehat\\beta_4 \\cdot 0 + \\\\ &  \\widehat\\beta_5 I(\\text{high income}) \\cdot 1 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 0+ \\\\ & \\widehat\\beta_7 I(\\text{high income}) \\cdot 0 \\\\\n\\widehat{LE} = &\\big(\\widehat\\beta_0+\\widehat\\beta_2\\big) + \\\\ &\\big(\\widehat\\beta_1 + \\widehat\\beta_5\\big)I(\\text{high income}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"25%\"}\n::: proposition\n::: prop-title\nAsia\n:::\n\n::: prop-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 \\cdot 1 + \\widehat\\beta_4 \\cdot 0 + \\\\ & \\widehat\\beta_5 I(\\text{high income}) \\cdot 0 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 1+ \\\\ & \\widehat\\beta_7 I(\\text{high income}) \\cdot 0 \\\\\n\\widehat{LE} = &\\big(\\widehat\\beta_0+\\widehat\\beta_3\\big) + \\\\ &\\big(\\widehat\\beta_1 + \\widehat\\beta_6\\big)I(\\text{high income}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"25%\"}\n::: definition\n::: def-title\nEurope\n:::\n\n::: def-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 \\cdot 0 + \\widehat\\beta_4 \\cdot 1 + \\\\ & \\widehat\\beta_5 I(\\text{high income}) \\cdot 0 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 0+ \\\\ & \\widehat\\beta_7 I(\\text{high income}) \\cdot 1 \\\\\n\\widehat{LE} = &\\big(\\widehat\\beta_0+\\widehat\\beta_4\\big) + \\\\ & \\big(\\widehat\\beta_1 + \\widehat\\beta_7\\big)I(\\text{high income}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Comparing fitted regression *means* for each income level {.smaller}\n\n$$\\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & 60.85 + 2.10 \\cdot I(\\text{high income}) + 10.8 \\cdot I(\\text{Americas}) + 7.47\\cdot  I(\\text{Asia}) + 11.50 \\cdot I(\\text{Europe}) + \\\\ & 2.64 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + 1.54 \\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & 2.38 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n::: columns\n::: column\n::: proof1\n::: proof-title\nFor lower income countries: $I(\\text{high income}) =0$\n:::\n\n::: proof-cont\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot 0 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot 0\\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot 0 \\cdot I(\\text{Asia})+ \\widehat\\beta_7 \\cdot 0\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: column\n::: fact\n::: fact-title\nFor higher income countries: $I(\\text{high income}) =1$\n:::\n\n::: fact-cont\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot 1 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot 1\\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot 1 \\cdot I(\\text{Asia})+ \\widehat\\beta_7 \\cdot 1\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & (\\widehat\\beta_0 + \\widehat\\beta_1)  + (\\widehat\\beta_2 + \\widehat\\beta_5) I(\\text{Americas}) + (\\widehat\\beta_3 + \\widehat\\beta_6)  I(\\text{Asia}) + \\\\ & (\\widehat\\beta_4 + \\widehat\\beta_7)  I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n- Example interpretation: The America's effect on mean life expectancy increases $\\widehat{\\beta}_5$ comparing high income to low income countries.\n\n## Let's take a look back at the plot\n\n::: columns\n::: {.column width=\"50%\"}\n::: proof1\n::: proof-title\nFor lower income countries: $I(\\text{high income}) =0$\n:::\n\n::: proof-cont\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\\\ & \\widehat\\beta_4 I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n\n::: fact\n::: fact-title\nFor higher income countries: $I(\\text{high income}) =1$\n:::\n\n::: fact-cont\n$$ \\begin{aligned}\n\\widehat{LE} = & (\\widehat\\beta_0 + \\widehat\\beta_1)  + (\\widehat\\beta_2 + \\widehat\\beta_5) I(\\text{Americas}) + \\\\& (\\widehat\\beta_3 + \\widehat\\beta_6)  I(\\text{Asia}) +  (\\widehat\\beta_4 + \\widehat\\beta_7)  I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r fig.height=8.5, fig.width=8.5, warning=F, fig.align='center'}\n#| echo: false\nggplot(gapm_sub, aes(x = four_regions, y = LifeExpectancyYrs, \n                  color = income_levels2)) +\n  geom_jitter(size = 2, alpha = .6, width = 0.2) +\n  stat_summary(fun = mean, geom = \"point\", size = 8, shape = 18) +\n  labs(x = \"World Regions\", \n       y = \"Life expectancy (years)\",\n       title = \"Life expectancy vs. World Region\", \n       color = \"Income level\") +\n  theme(axis.title = element_text(size = 20), \n        axis.text = element_text(size = 20), \n        title = element_text(size = 20), \n        legend.text=element_text(size= 18), legend.position = \"bottom\") +\n  scale_color_manual(values=c(\"#FF8021\", \"#34AC8B\"))\n```\n:::\n:::\n\n## Interpretation for interaction between two categorical variables\n\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income})\\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & \\bigg[\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot I(\\text{high income})\\bigg]  + \\bigg[\\widehat\\beta_2 + \\widehat\\beta_5 \\cdot I(\\text{high income})\\bigg] I(\\text{Americas}) + \\\\ & \\bigg[\\widehat\\beta_3 + \\widehat\\beta_6 \\cdot I(\\text{high income})\\bigg]  I(\\text{Asia}) +  \\bigg[\\widehat\\beta_4 + \\widehat\\beta_7 \\cdot I(\\text{high income})\\bigg]  I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n-   Interpretation:\n    -   $\\beta_1$ = mean change in the Africa's life expectancy, comparing high income to low income countries\n    -   $\\beta_5$ = mean change in the Americas' effect, comparing high income to low income countries\n    -   $\\beta_6$ = mean change in Asia's effect, comparing high income to low income countries\n    -   $\\beta_7$ = mean change in Europe's effect, comparing high income to low income countries\n\n## Test interaction between two categorical variables (1/2) {.smaller}\n\n-   We run an F-test for a group of coefficients ($\\beta_5$, $\\beta_6$, $\\beta_7$) in the below model (see lesson 9)\n\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\beta_3 I(\\text{Asia}) + \\beta_4 I(\\text{Europe}) + \\\\ & \\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe})+ \\epsilon \\end{aligned}$$\n\n::: columns\n::: {.column width=\"45%\"}\n::: proof1\n::: proof-title\nNull $H_0$\n:::\n\n::: proof-cont\n$\\beta_5= \\beta_6 = \\beta_7 =0$\n:::\n:::\n:::\n\n::: {.column width=\"55%\"}\n::: definition\n::: def-title\nAlternative $H_1$\n:::\n\n::: def-cont\n$\\beta_5\\neq0$ and/or $\\beta_6\\neq0$ and/or $\\beta_7\\neq0$\n:::\n:::\n:::\n:::\n\n::: columns\n::: {.column width=\"45%\"}\n::: proof1\n::: proof-title\nNull / Smaller / Reduced model\n:::\n\n::: proof-cont\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\\\& \\beta_3 I(\\text{Asia}) + \\beta_4 I(\\text{Europe}) + \\epsilon \\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"55%\"}\n::: definition\n::: def-title\nAlternative / Larger / Full model\n:::\n\n::: def-cont\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\beta_3 I(\\text{Asia}) + \\\\ & \\beta_4 I(\\text{Europe}) + \\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\\\ & \\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe})+ \\epsilon \\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Test interaction between two categorical variables (2/2)\n\n-   Fit the reduced and full model\n\n```{r}\n#| echo: true\nm_int_wr_inc_red = lm(LifeExpectancyYrs ~ income_levels2 + four_regions, \n                   data = gapm_sub)\nm_int_wr_inc_full = lm(LifeExpectancyYrs ~ income_levels2 + four_regions +\n                          income_levels2*four_regions, data = gapm_sub)\n```\n\n-   Display the ANOVA table with F-statistic and p-value\n\n```{r}\nanova(m_int_wr_inc_red, m_int_wr_inc_full) %>% tidy() %>% gt() %>% tab_options(table.font.size = 35) %>% fmt_number(decimals = 3)\n\n# newdata <- data.frame(four_regions = c(\"Africa\", \"Americas\", \"Asia\", \"Europe\"), \n#                       FLR_c = c()) \n# (pred = predict(m_int_wr_full, \n#                 newdata=newdata, \n#                 interval=\"confidence\"))\n```\n\n-   Conclusion: There is not a significant interaction between world region and income level (p = 0.928).\n\n# Learning Objectives\n\n**Last time:**\n\n1.  Define confounders and effect modifiers, and how they interact with the main relationship we model.\n2.  Interpret the interaction component of a model with **a binary categorical covariate and continuous covariate**, and how the main variable's effect changes.\n3.  Interpret the interaction component of a model with **a multi-level categorical covariate and continuous covariate**, and how the main variable's effect changes.\n\n**This time:**\n\n4.  Interpret the interaction component of a model with **two categorical covariates**, and how the main variable's effect changes.\n\n::: lob\n5.  Interpret the interaction component of a model with **two continuous covariates**, and how the main variable's effect changes.\n:::\n\n## Do we think food supply is an effect modifier for female literacy rate?\n\n::: columns\n::: {.column width=\"40%\"}\n-   We can start by visualizing the relationship between life expectancy and female literacy rate *by food supply*\n\n-   Questions of interest: Does the effect of female literacy rate on life expectancy differ depending on food supply?\n\n    -   This is the same as: Is food supply is an effect modifier for female literacy rate? Is food supply an effect modifier of the association between life expectancy and female literacy rate?\n\n-   Let's run an interaction model to see!\n:::\n\n::: {.column width=\"60%\"}\n```{r fig.height=4, fig.width=6, warning=F, fig.align='center'}\n#| echo: false\nm_int_fs = lm(LifeExpectancyYrs ~ FemaleLiteracyRate*FoodSupplykcPPD, data = gapm_sub)\n(mr1_2d = ggPredict(m_int_fs, interactive = T) )\n```\n:::\n:::\n\n## Model with interaction between *two continuous variables*\n\nModel we are fitting:\n\n$$ LE = \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\beta_3 FLR^c \\cdot FS^c + \\epsilon$$\n\n-   $LE$ as life expectancy\n-   $FLR^c$ as the **centered** around the mean female literacy rate (continuous variable)\n-   $FS^c$ as the **centered** around the mean food supply (continuous variable)\n\n```{r}\n#| code-fold: true\n#| code-summary: \"Code to center FLR and FS\"\n#| echo: true\ngapm_sub = gapm_sub %>% \n  mutate(FLR_c = FemaleLiteracyRate - mean(FemaleLiteracyRate), \n         FS_c = FoodSupplykcPPD - mean(FoodSupplykcPPD))\nmean_FS = mean(gapm_sub$FoodSupplykcPPD) %>% round(digits = 0)\nmean_FLR = mean(gapm_sub$FemaleLiteracyRate) %>% round(digits = 2)\n```\n\nIn R:\n\n```{r}\n#| echo: true\n\nm_int_fs = lm(LifeExpectancyYrs ~ FLR_c + FS_c + FLR_c*FS_c, data = gapm_sub)\n```\n\nOR\n\n```{r}\n#| echo: true\n\nm_int_fs = lm(LifeExpectancyYrs ~ FLR_c*FS_c, data = gapm_sub)\n```\n\n## Displaying the regression table and writing fitted regression equation\n\n```{r}\n#| echo: true\ntidy_m_fs = tidy(m_int_fs, conf.int=T) \ntidy_m_fs %>% gt() %>% tab_options(table.font.size = 35) %>% fmt_number(decimals = 5)\n```\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\widehat\\beta_2 FS^c + \\widehat\\beta_3 FLR^c \\cdot FS^c \\\\\n\\widehat{LE} = & `r round(tidy_m_fs$estimate[1],2)` + `r round(tidy_m_fs$estimate[2],2)` \\cdot FLR^c + `r round(tidy_m_fs$estimate[3],2)` \\cdot FS^c - 0.00001 \\cdot FLR^c \\cdot FS^c\n\\end{aligned}$$\n\n## Comparing fitted regression lines for various food supply values\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\widehat\\beta_2 FS^c + \\widehat\\beta_3 FLR^c \\cdot FS^c \\\\\n\\widehat{LE} = & `r round(tidy_m_fs$estimate[1],2)` + `r round(tidy_m_fs$estimate[2],2)` \\cdot FLR^c + `r round(tidy_m_fs$estimate[3],2)` \\cdot FS^c - 0.00001 \\cdot FLR^c \\cdot FS^c\n\\end{aligned}$$\n\nTo identify different lines, we need to pick example values of Food Supply:\n\n::: columns\n::: {.column width=\"33%\"}\n::: FS1\n::: FS1-title\nFood Supply of `r mean_FS -1000` kcal PPD\n:::\n\n::: FS1-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\\\ & \\widehat\\beta_2 \\cdot (-1000) + \\\\ & \\widehat\\beta_3 FLR^c \\cdot (-1000) \\\\\n\\widehat{LE} = & \\big(\\widehat\\beta_0 - 1000 \\widehat\\beta_2 \\big)+ \\\\ & \\big(\\widehat\\beta_1 - 1000 \\widehat\\beta_3  \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"33%\"}\n::: FS2\n::: FS2-title\nFood Supply of `r mean_FS` kcal PPD\n:::\n\n::: FS2-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\\\ & \\widehat\\beta_3 FLR^c \\cdot 0 \\\\\n\\widehat{LE} = & \\big(\\widehat\\beta_0 \\big)+ \\\\ & \\big(\\widehat\\beta_1 \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"33%\"}\n::: FS3\n::: FS3-title\nFood Supply of `r mean_FS + 1000` kcal PPD\n:::\n\n::: FS3-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\\\ & \\widehat\\beta_2 \\cdot 1000 + \\\\ & \\widehat\\beta_3 FLR^c \\cdot 1000 \\\\\n\\widehat{LE} = & \\big(\\widehat\\beta_0 + 1000 \\widehat\\beta_2 \\big)+ \\\\ & \\big(\\widehat\\beta_1 + 1000 \\widehat\\beta_3  \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Poll Everywhere Question??\n\n## Interpretation for interaction between two continuous variables\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\widehat\\beta_2 FS^c + \\widehat\\beta_3 FLR^c \\cdot FS^c \\\\\n\\widehat{LE} = & \\bigg[\\widehat\\beta_0 + \\widehat\\beta_2 \\cdot FS^c \\bigg] + \\underbrace{\\bigg[\\widehat\\beta_1 + \\widehat\\beta_3 \\cdot FS^c \\bigg]}_\\text{FLR's effect} FLR \\\\\n\\end{aligned}$$\n\n-   Interpretation:\n\n    -   $\\beta_3$ = mean change in female literacy rate's effect, for every one kcal PPD increase in food supply\n\n-   In summary, the interaction term can be interpreted as \"difference in adjusted female literacy rate effect for every 1 kcal PPD increase in food supply\"\n\n-   It will be helpful to test the interaction to round out this interpretation!!\n\n## Test interaction between two continuous variables\n\n-   We run an F-test for a single coefficients ($\\beta_3$) in the below model (see lesson 9)\n\n$$ LE = \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\beta_3 FLR^c \\cdot FS^c + \\epsilon$$\n\n::: columns\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"40%\"}\n::: proof1\n::: proof-title\nNull $H_0$\n:::\n\n::: proof-cont\n$$\\beta_3=0$$\n:::\n:::\n:::\n\n::: {.column width=\"40%\"}\n::: definition\n::: def-title\nAlternative $H_1$\n:::\n\n::: def-cont\n$$\\beta_3\\neq0$$\n:::\n:::\n:::\n\n::: {.column width=\"10%\"}\n:::\n:::\n\n::: columns\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"40%\"}\n::: proof1\n::: proof-title\nNull / Smaller / Reduced model\n:::\n\n::: proof-cont\n$$ LE = \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\epsilon$$\n:::\n:::\n:::\n\n::: {.column width=\"40%\"}\n::: definition\n::: def-title\nAlternative / Larger / Full model\n:::\n\n::: def-cont\n$$\\begin{aligned}\nLE = & \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\\\ & \\beta_3 FLR^c \\cdot FS^c + \\epsilon\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Test interaction between two continuous variables\n\n-   Fit the reduced and full model\n\n```{r}\n#| echo: true\nm_int_fs_red = lm(LifeExpectancyYrs ~ FLR_c + FS_c, \n                   data = gapm_sub)\nm_int_fs_full = lm(LifeExpectancyYrs ~ FLR_c + FS_c +\n                  FLR_c*FS_c, data = gapm_sub)\n```\n\n \n\n```{r}\n#| code-fold: true\n#| code-summary: \"Display the ANOVA table with F-statistic and p-value\"\n#| echo: true\nanova(m_int_fs_red, m_int_fs_full) %>% tidy() %>% \n  gt() %>% tab_options(table.font.size = 35) %>% fmt_number(decimals = 3)\n```\n\n-   Conclusion: There is not a significant interaction between female literacy rate and food supply (p = 0.945). Food supply is not an effect modifier of the association between female literacy rate and life expectancy.\n\n# Learning Objective\n\n**Bonus learning objective that's not really bonus but just a last minute addition**\n\n6. Report results for a best-fit line (with confidence intervals) at different levels of an effect measure modifier\n\n## How to find the confidence interval for each slope?\n\n- In the example with FS and FLR, we showed:\n\n::: FS3\n::: FS3-title\nBest-fit line for Food Supply of `r mean_FS + 1000` kcal PPD\n:::\n::: FS3-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\big(\\widehat\\beta_0 + 1000 \\widehat\\beta_2 \\big)+  \\big(\\widehat\\beta_1 + 1000 \\widehat\\beta_3  \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n\n- Often, we want to report the estimate of the combined coefficients: $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$\n\n  - This allows us to make a statement like: \"At a food supply of 3812 kcal PPD, mean life expectancy increases ($\\widehat\\beta_1 + 1000 \\widehat\\beta_3$) years for every one percent increase in female literacy rate (95% CI: \\_\\_, \\_\\_).\"\n\n \n\n- We can calculate $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$ by using the values of the estimated coefficients\n\n- BUT we always want to have a **95% confidence interval** when we report this combined estimate!!\n\n## Getting a 95% confidence interval requires linear combinations!\n\n- If we want a confidence interval for $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$, then we would use the formula:\n\n$$\\bigg(\\widehat\\beta_1 + 1000 \\widehat\\beta_3 \\bigg) \\pm t^* \\times SE_{(\\beta_1 + 1000 \\beta_3)}$$\n\n- The hard part is figuring out what $SE_{(\\beta_1 + 1000 \\beta_3)}$ (or $\\text{Var}(\\beta_1 + 1000 \\beta_3)$) equals\n\n- We need to go back to variance of linear combinations (BSTA 512/612, EPI 525):\n$$\\text{Var}(aX + bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y) + 2ab\\text{Cov}(X, Y)$$\nor\n$$\\text{Var}(aX - bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y) - 2ab\\text{Cov}(X, Y)$$\n\n## Reference: calculating $SE_{(\\beta_1 + 1000 \\beta_3)}$ by hand\n\n- A helpful function that returns the variance-covariance matric of all the coefficients in model `m_int_fs`:\n\n::: columns\n::: {.column width=\"70%\"}\n```{r}\n#| echo: true\nvcov(m_int_fs)\n```\n:::\n::: {.column width=\"30%\"}\n$$ \\begin{aligned}\n\\text{Var}(\\beta_1) & = `r round(vcov(m_int_fs)[2,2], 9)` \\\\\n\\text{Var}(\\beta_3) & = `r round(vcov(m_int_fs)[4,4], 9)` \\\\\n\\text{Cov}(\\beta_1, \\beta_3) & = `r round(vcov(m_int_fs)[2,4], 9)` \\\\\n\\end{aligned}$$\n:::\n:::\n\n$$ \\begin{aligned}\n\\text{Var}(\\beta_1 + 1000 \\beta_3) & = \\text{Var}(\\beta_1) + 1000^2\\text{Var}(\\beta_3) + 2000\\text{Cov}(\\beta_1, \\beta_3) \\\\ \n\\text{Var}(\\beta_1 + 1000 \\beta_3) & = `r round(vcov(m_int_fs)[2,2], 9)` + 1000^2 \\times `r round(vcov(m_int_fs)[4,4], 9)` + 2000 \\times `r round(vcov(m_int_fs)[2,4], 9)` \\\\ \n\\text{Var}(\\beta_1 + 1000 \\beta_3) & = `r round(vcov(m_int_fs)[2,2] + 1000^2 * vcov(m_int_fs)[4,4] + 2000 * vcov(m_int_fs)[2,4], 9)` \\\\\nSE_{(\\beta_1 + 1000 \\beta_3)} & = \\sqrt{`r round(vcov(m_int_fs)[2,2] + 1000^2 * vcov(m_int_fs)[4,4] + 2000 * vcov(m_int_fs)[2,4], 9)`} \\\\ \nSE_{(\\beta_1 + 1000 \\beta_3)} & = `r round(sqrt(vcov(m_int_fs)[2,2] + 1000^2 * vcov(m_int_fs)[4,4] + 2000 * vcov(m_int_fs)[2,4]), 9)`\n\\end{aligned}$$\n\n\n## We can use R and `estimable()` to find the estimate and CI\n\nFor $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$:\n\n```{r}\n#| echo: true\n\nlibrary(gmodels)\nm_int_fs %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"FS_c\"        = 0,      # beta2\n                     \"FLR_c:FS_c\"  = 1000),  # beta3\n                   conf.int = 0.95)\n```\n\n```{r}\nm_int_fs_3812 = m_int_fs %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"FS_c\"        = 0,      # beta2\n                     \"FLR_c:FS_c\"  = 1000),  # beta3\n                   conf.int = 0.95)\n```\n\n \n\n**Our conclusion:** At a food supply of 3812 kcal PPD, mean life expectancy increases `r round(m_int_fs_3812$Estimate, 5)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_fs_3812$Lower.CI, 5)`, `r round(m_int_fs_3812$Upper.CI, 5)`).\n\n## Another example: income (binary) and FLR (1/2)\n\n```{r}\n#| echo: true\n\nm_int_inc2 = gapm_sub %>% \n  lm(formula = LifeExpectancyYrs ~ FLR_c*income_levels2)\n```\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR + \\widehat\\beta_2 I(\\text{high income}) + \\widehat\\beta_3 FLR \\cdot I(\\text{high income}) \\\\\n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR - 16.65 \\cdot I(\\text{high income}) + 0.228 \\cdot FLR \\cdot I(\\text{high income})\n\\end{aligned}$$\n\n::: columns\n::: column\n::: proof1\n::: proof-title\nFor lower income countries: $I(\\text{high income}) =0$\n:::\n\n::: proof-cont\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR + \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 FLR \\cdot 0 \\\\\n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR - 16.65 \\cdot 0 + \\\\\n& 0.228 \\cdot FLR \\cdot 0 \\\\ \n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR\\\\ \n\\end{aligned}$$\n:::\n:::\n:::\n\n::: column\n::: fact\n::: fact-title\nFor higher income countries: $I(\\text{high income}) =1$\n:::\n\n::: fact-cont\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR + \\widehat\\beta_2 \\cdot 1 + \\widehat\\beta_3 FLR \\cdot 1 \\\\\n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR - 16.65 \\cdot 1 + \\\\ & 0.228 \\cdot FLR \\cdot 1 \\\\ \n\\widehat{LE} = & `r 54.85 - 16.65` + `r 0.156 + 0.228` \\cdot FLR\\\\ \n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Another example: income (binary) and FLR (2/2)\n\n\n```{r}\n#| echo: true\n\nm_int_inc2$coefficients # I just need to see the exact names\nm_int_inc2 %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"income_levels2Higher income\" = 0,      # beta2\n                     \"FLR_c:income_levels2Higher income\"  = 1),  # beta3\n                   conf.int = 0.95)\n```\n\n```{r}\nm_int_high_inc = m_int_inc2 %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"income_levels2Higher income\" = 0,      # beta2\n                     \"FLR_c:income_levels2Higher income\"  = 1),  # beta3\n                   conf.int = 0.95)\n```\n\n \n\n**Our conclusion:** For countries with high income, mean life expectancy increases `r round(m_int_high_inc$Estimate, 3)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_high_inc$Lower.CI, 3)`, `r round(m_int_high_inc$Upper.CI, 3)`).\n\n## If our example had an effect measure modifier\n\n```{r}\nm_int_low_inc = m_int_inc2 %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 0,      # beta1\n                     \"income_levels2Higher income\" = 1,      # beta2\n                     \"FLR_c:income_levels2Higher income\"  = 0),  # beta3\n                   conf.int = 0.95)\n```\n\n- None of our examples had a significant interaction, so it's hard to demonstrate exactly how we would report this\n\n- Let's say, **just for example**, that income had a significant interaction with FLR\n  - How would we report this to an audience??\n  \n- Here's how to report on an interaction/EMM:\n\n  - We found that a country's income status (high or low) is a significant effect measure modifier on female literacy rate (*include p-value for interaction test here*). For countries with high income, mean life expectancy increases `r round(m_int_high_inc$Estimate, 3)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_high_inc$Lower.CI, 3)`, `r round(m_int_high_inc$Upper.CI, 3)`). For countries with low income, mean life expectancy increases `r round(m_int_low_inc$Estimate, 3)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_low_inc$Lower.CI, 3)`, `r round(m_int_low_inc$Upper.CI, 3)`).\"\n\n# Extra Reference Material\n\n## General interpretation of the interaction term (reference)\n\n$E[Y\\mid X_{1},X_{2} ]=\\beta_0 + \\underbrace{(\\beta_1+\\beta_3X_{2}) }_\\text{$X_{1}$'s effect} X_{1}+ \\underbrace{\\beta_2X_{2}}_\\text{$X_{2}$ held constant}$\\\n${\\color{white}{E[Y\\mid X_{1},X_{2} ]}}=\\beta_0 + \\underbrace{(\\beta_2+\\beta_3X_{1}) }_\\text{$X_{2}$'s effect}X_{2} + \\underbrace{\\beta_1X_{1}}_\\text{$X_{1}$ held constant}$\n\n-   Interpretation:\n\n    -   $\\beta_3$ = mean change in $X_{1}$'s effect, per unit increase in $X_{2}$;\\\n\n    -   [$\\beta_3$]{style=\"color: white\"} = mean change in $X_{2}$'s effect, per unit increase in $X_{1}$;\n\n    -   where the \"$X_{1}$ effect\" equals the change in $E[Y]$ per unit increase in $X_{1}$ with $X_{2}$ held constant, i.e. \"adjusted $X_{1}$ effect\"\n\n-   In summary, the interaction term can be interpreted as \"difference in adjusted $X_1$ (or $X_2$) effect per unit increase in $X_2$ (or $X_1$)\"\n\n## A glimpse at how interactions might be incorporated into model selection {.smaller}\n\n1.  Identify outcome (Y) and primary explanatory (X) variables\n\n2.  Decide which other variables might be important and could be potential confounders. Add these to the model.\n\n    -   This is often done by indentifying variables that previous research deemed important, or researchers believe could be important\n    -   From a statistical perspective, we often include variables that are significantly associated with the outcome (in their respective SLR)\n\n3.  (Optional step) Test 3 way interactions\n\n    -   This makes our model incredibly hard to interpret. Our class will not cover this!!\n    -   We will skip to testing 2 way interactions\n\n4.  Test 2 way interactions\n\n    -   When testing a 2 way interaction, make sure the full and reduced models contain the main effects\n\n    -   First test all the 2 way interactions together using a partial F-test (with $alpha = 0.10$)\n\n        -   If this test not significant, do not test 2-way interactions individually\n        -   If partial F-test is significant, then test each of the 2-way interactions\n\n5.  Remaining main effects - to include of not to include?\n\n    -   For variables that are included in any interactions, they will be automatically included as main effects and thus not checked for confounding\n\n    -   For variables that are not included in any interactions:\n\n        -   Check to see if they are confounders by seeing whether exclusion of the variable(s) changes any of the coefficient of the primary explanatory variable (including interactions) X by more than 10%\n\n            -   If any of X's coefficients change when removing the potential confounder, then keep it in the model\n","srcMarkdownNoYaml":"\n\n```{r}\n#| label: \"setup\" \n#| include: false\n#| message: false\n#| warning: false\n\nlibrary(tidyverse)\nlibrary(janitor)\nlibrary(knitr)\nlibrary(broom)\nlibrary(rstatix)\nlibrary(gt)\nlibrary(readxl)\n#----------\n# new packages\n# install.packages(\"describedata\")\nlibrary(describedata) # gladder()\nlibrary(gridExtra)   # grid.arrange()\nlibrary(ggfortify)  # autoplot(model)\n# New Day 6\nlibrary(gtsummary)\n\n# New Day 7\nlibrary(plotly) # for plot_ly() command\nlibrary(GGally) # for ggpairs() command \nlibrary(ggiraphExtra)   # for ggPredict() command\n\n# Load the data - update code if the csv file is not in the same location on your computer\n# If you need to download the file, please go to ur shared folder under Data > Slides\ngapm <- read_excel(\"data/Gapminder_vars_2011.xlsx\", \n                   na = \"NA\")  # important!!!! \n\n\ngapm_sub <- gapm %>% # called it gapm2_sub3 to be consistent with Day 7 notes\n  drop_na(LifeExpectancyYrs, FemaleLiteracyRate, four_regions, FoodSupplykcPPD) %>%\n  mutate(four_regions = factor(four_regions, \n                               levels = c(\"africa\", \"americas\", \n                                          \"asia\", \"europe\"), \n                               labels = c(\"Africa\", \"Americas\", \n                                          \"Asia\", \"Europe\"))) %>%\n  rename(income_levels = `World bank, 4 income groups 2017`) %>%\n  mutate(income_levels1 = factor(income_levels, \n                                levels = c(\"Low income\", \n                                           \"Lower middle income\", \n                                           \"Upper middle income\", \n                                           \"High income\")), \n         income_levels2 = relevel(factor(income_levels, \n                                levels = c(\"Low income\", \n                                           \"Lower middle income\", \n                                           \"Upper middle income\", \n                                           \"High income\"), \n                                labels = c(\"Lower income\", \"Lower income\", \n                                            \"Higher income\", \"Higher income\")), \n                                ref = \"Lower income\"))\n\n```\n\n# Learning Objectives\n\n**Last time:**\n\n1.  Define confounders and effect modifiers, and how they interact with the main relationship we model.\n2.  Interpret the interaction component of a model with **a binary categorical covariate and continuous covariate**, and how the main variable's effect changes.\n3.  Interpret the interaction component of a model with **a multi-level categorical covariate and continuous covariate**, and how the main variable's effect changes.\n\n**This time:**\n\n4.  Interpret the interaction component of a model with **two categorical covariates**, and how the main variable's effect changes.\n5.  Interpret the interaction component of a model with **two continuous covariates**, and how the main variable's effect changes.\n6. Report results for a best-fit line (with confidence intervals) at different levels of an effect measure modifier\n\n# Learning Objectives\n\n**Last time:**\n\n1.  Define confounders and effect modifiers, and how they interact with the main relationship we model.\n2.  Interpret the interaction component of a model with **a binary categorical covariate and continuous covariate**, and how the main variable's effect changes.\n3.  Interpret the interaction component of a model with **a multi-level categorical covariate and continuous covariate**, and how the main variable's effect changes.\n\n**This time:**\n\n::: lob\n4.  Interpret the interaction component of a model with **two categorical covariates**, and how the main variable's effect changes.\n:::\n\n5.  Interpret the interaction component of a model with **two continuous covariates**, and how the main variable's effect changes.\n\n## Do we think income level can be an effect modifier for world region?\n\n::: columns\n::: column\n-   Taking a break from female literacy rate to demonstrate interactions for two categorical variables\n\n-   We can start by visualizing the relationship between life expectancy and world region *by income level*\n\n-   Questions of interest: Does the effect of world region on life expectancy differ depending on income level?\n\n    -   This is the same as: Is income level an effect modifier for world region?\n\n-   Let's run an interaction model to see!\n:::\n\n::: column\n```{r fig.height=7, fig.width=9, warning=F, fig.align='center'}\n#| echo: false\nggplot(gapm_sub, aes(x = four_regions, y = LifeExpectancyYrs, \n                  color = income_levels2)) +\n  geom_jitter(size = 2, alpha = .6, width = 0.2) +\n  stat_summary(fun = mean, geom = \"point\", size = 8, shape = 18) +\n  labs(x = \"World Regions\", \n       y = \"Life expectancy (years)\",\n       title = \"Life expectancy vs. World Region\", \n       color = \"Income level\") +\n  theme(axis.title = element_text(size = 20), \n        axis.text = element_text(size = 20), \n        title = element_text(size = 20), \n        legend.text=element_text(size= 18)) +\n  scale_color_manual(values=c(\"#FF8021\", \"#34AC8B\"))\n```\n:::\n:::\n\n## Model with interaction between a *multi-level categorical and binary variables*\n\nModel we are fitting:\n\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\beta_3 I(\\text{Asia}) + \\beta_4 I(\\text{Europe}) + \\\\ & \\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe})+ \\epsilon \\end{aligned}$$\n\n-   $LE$ as life expectancy\n-   $I(\\text{high income})$ as indicator of high income\n-   $I(\\text{Americas})$, $I(\\text{Asia})$, $I(\\text{Europe})$ as the indicator for each world region\n\nIn R:\n\n```{r}\n#| echo: true\n# gapm_sub = gapm_sub %>% mutate(income_levels2 = relevel(income_levels2, ref = \"Higher income\")) # for poll everywhere\n\nm_int_wr_inc = lm(LifeExpectancyYrs ~ income_levels2 + four_regions +\n                  income_levels2*four_regions, data = gapm_sub)\nm_int_wr_inc = lm(LifeExpectancyYrs ~ income_levels2*four_regions, \n                data = gapm_sub)\n```\n\n## Displaying the regression table and writing fitted regression equation\n\n```{r}\n#| echo: true\n\ntidy(m_int_wr_inc, conf.int=T) %>% gt() %>% tab_options(table.font.size = 25) %>% fmt_number(decimals = 3)\n```\n\n$$\\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & 60.85 + 2.10 \\cdot I(\\text{high income}) + 10.8 \\cdot I(\\text{Americas}) + 7.47\\cdot  I(\\text{Asia}) + 11.50 \\cdot I(\\text{Europe}) + \\\\ & 2.64 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + 1.54 \\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & 2.38 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n## Poll Everywhere Question 4\n\n::: columns\n::: {.column width=\"60%\"}\n:::\n\n::: {.column width=\"40%\"}\n```{r fig.height=8, fig.width=8, warning=F, fig.align='center'}\n#| echo: false\nggplot(gapm_sub, aes(x = four_regions, y = LifeExpectancyYrs, \n                  color = income_levels2)) +\n  geom_jitter(size = 2, alpha = .6, width = 0.2) +\n  stat_summary(fun = mean, geom = \"point\", size = 8, shape = 18) +\n  labs(x = \"World Regions\", \n       y = \"Life expectancy (years)\",\n       title = \"Life expectancy vs. World Region\", \n       color = \"Income level\") +\n  theme(axis.title = element_text(size = 20), \n        axis.text = element_text(size = 20), \n        title = element_text(size = 20), \n        legend.text=element_text(size= 18), legend.position = \"bottom\") +\n  scale_color_manual(values=c(\"#FF8021\", \"#34AC8B\"))\n```\n:::\n:::\n\n\n## Comparing fitted regression *means* for each world region {.smaller}\n\n$$\\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & 60.85 + 2.10 \\cdot I(\\text{high income}) + 10.8 \\cdot I(\\text{Americas}) + 7.47\\cdot  I(\\text{Asia}) + 11.50 \\cdot I(\\text{Europe}) + \\\\ & 2.64 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + 1.54 \\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & 2.38 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n::: columns\n::: {.column width=\"25%\"}\n::: proof1\n::: proof-title\nAfrica\n:::\n\n::: proof-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 \\cdot 0 + \\widehat\\beta_4 \\cdot 0 + \\\\ & \\widehat\\beta_5 I(\\text{high income}) \\cdot 0 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 0+ \\\\& \\widehat\\beta_7 I(\\text{high income}) \\cdot 0 \\\\\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income})\\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"25%\"}\n::: fact\n::: fact-title\nThe Americas\n:::\n\n::: fact-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 1 + \\widehat\\beta_3 \\cdot 0 + \\widehat\\beta_4 \\cdot 0 + \\\\ &  \\widehat\\beta_5 I(\\text{high income}) \\cdot 1 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 0+ \\\\ & \\widehat\\beta_7 I(\\text{high income}) \\cdot 0 \\\\\n\\widehat{LE} = &\\big(\\widehat\\beta_0+\\widehat\\beta_2\\big) + \\\\ &\\big(\\widehat\\beta_1 + \\widehat\\beta_5\\big)I(\\text{high income}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"25%\"}\n::: proposition\n::: prop-title\nAsia\n:::\n\n::: prop-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 \\cdot 1 + \\widehat\\beta_4 \\cdot 0 + \\\\ & \\widehat\\beta_5 I(\\text{high income}) \\cdot 0 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 1+ \\\\ & \\widehat\\beta_7 I(\\text{high income}) \\cdot 0 \\\\\n\\widehat{LE} = &\\big(\\widehat\\beta_0+\\widehat\\beta_3\\big) + \\\\ &\\big(\\widehat\\beta_1 + \\widehat\\beta_6\\big)I(\\text{high income}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"25%\"}\n::: definition\n::: def-title\nEurope\n:::\n\n::: def-cont\n$$\\begin{aligned} \n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 \\cdot 0 + \\widehat\\beta_4 \\cdot 1 + \\\\ & \\widehat\\beta_5 I(\\text{high income}) \\cdot 0 + \\\\ & \\widehat\\beta_6 I(\\text{high income}) \\cdot 0+ \\\\ & \\widehat\\beta_7 I(\\text{high income}) \\cdot 1 \\\\\n\\widehat{LE} = &\\big(\\widehat\\beta_0+\\widehat\\beta_4\\big) + \\\\ & \\big(\\widehat\\beta_1 + \\widehat\\beta_7\\big)I(\\text{high income}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Comparing fitted regression *means* for each income level {.smaller}\n\n$$\\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & 60.85 + 2.10 \\cdot I(\\text{high income}) + 10.8 \\cdot I(\\text{Americas}) + 7.47\\cdot  I(\\text{Asia}) + 11.50 \\cdot I(\\text{Europe}) + \\\\ & 2.64 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + 1.54 \\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & 2.38 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n::: columns\n::: column\n::: proof1\n::: proof-title\nFor lower income countries: $I(\\text{high income}) =0$\n:::\n\n::: proof-cont\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot 0 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot 0\\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot 0 \\cdot I(\\text{Asia})+ \\widehat\\beta_7 \\cdot 0\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: column\n::: fact\n::: fact-title\nFor higher income countries: $I(\\text{high income}) =1$\n:::\n\n::: fact-cont\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot 1 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot 1\\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot 1 \\cdot I(\\text{Asia})+ \\widehat\\beta_7 \\cdot 1\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & (\\widehat\\beta_0 + \\widehat\\beta_1)  + (\\widehat\\beta_2 + \\widehat\\beta_5) I(\\text{Americas}) + (\\widehat\\beta_3 + \\widehat\\beta_6)  I(\\text{Asia}) + \\\\ & (\\widehat\\beta_4 + \\widehat\\beta_7)  I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n- Example interpretation: The America's effect on mean life expectancy increases $\\widehat{\\beta}_5$ comparing high income to low income countries.\n\n## Let's take a look back at the plot\n\n::: columns\n::: {.column width=\"50%\"}\n::: proof1\n::: proof-title\nFor lower income countries: $I(\\text{high income}) =0$\n:::\n\n::: proof-cont\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\\\ & \\widehat\\beta_4 I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n\n::: fact\n::: fact-title\nFor higher income countries: $I(\\text{high income}) =1$\n:::\n\n::: fact-cont\n$$ \\begin{aligned}\n\\widehat{LE} = & (\\widehat\\beta_0 + \\widehat\\beta_1)  + (\\widehat\\beta_2 + \\widehat\\beta_5) I(\\text{Americas}) + \\\\& (\\widehat\\beta_3 + \\widehat\\beta_6)  I(\\text{Asia}) +  (\\widehat\\beta_4 + \\widehat\\beta_7)  I(\\text{Europe}) \\\\\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n```{r fig.height=8.5, fig.width=8.5, warning=F, fig.align='center'}\n#| echo: false\nggplot(gapm_sub, aes(x = four_regions, y = LifeExpectancyYrs, \n                  color = income_levels2)) +\n  geom_jitter(size = 2, alpha = .6, width = 0.2) +\n  stat_summary(fun = mean, geom = \"point\", size = 8, shape = 18) +\n  labs(x = \"World Regions\", \n       y = \"Life expectancy (years)\",\n       title = \"Life expectancy vs. World Region\", \n       color = \"Income level\") +\n  theme(axis.title = element_text(size = 20), \n        axis.text = element_text(size = 20), \n        title = element_text(size = 20), \n        legend.text=element_text(size= 18), legend.position = \"bottom\") +\n  scale_color_manual(values=c(\"#FF8021\", \"#34AC8B\"))\n```\n:::\n:::\n\n## Interpretation for interaction between two categorical variables\n\n$$ \\begin{aligned}\n\\widehat{LE} = &\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot I(\\text{high income}) + \\widehat\\beta_2 I(\\text{Americas}) + \\widehat\\beta_3 I(\\text{Asia}) + \\widehat\\beta_4 I(\\text{Europe}) + \\\\ & \\widehat\\beta_5 \\cdot I(\\text{high income})\\cdot I(\\text{Americas}) + \\widehat\\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\widehat\\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe}) \\\\\n\\widehat{LE} = & \\bigg[\\widehat\\beta_0 + \\widehat\\beta_1 \\cdot I(\\text{high income})\\bigg]  + \\bigg[\\widehat\\beta_2 + \\widehat\\beta_5 \\cdot I(\\text{high income})\\bigg] I(\\text{Americas}) + \\\\ & \\bigg[\\widehat\\beta_3 + \\widehat\\beta_6 \\cdot I(\\text{high income})\\bigg]  I(\\text{Asia}) +  \\bigg[\\widehat\\beta_4 + \\widehat\\beta_7 \\cdot I(\\text{high income})\\bigg]  I(\\text{Europe}) \\\\\n\\end{aligned}$$\n\n-   Interpretation:\n    -   $\\beta_1$ = mean change in the Africa's life expectancy, comparing high income to low income countries\n    -   $\\beta_5$ = mean change in the Americas' effect, comparing high income to low income countries\n    -   $\\beta_6$ = mean change in Asia's effect, comparing high income to low income countries\n    -   $\\beta_7$ = mean change in Europe's effect, comparing high income to low income countries\n\n## Test interaction between two categorical variables (1/2) {.smaller}\n\n-   We run an F-test for a group of coefficients ($\\beta_5$, $\\beta_6$, $\\beta_7$) in the below model (see lesson 9)\n\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\beta_3 I(\\text{Asia}) + \\beta_4 I(\\text{Europe}) + \\\\ & \\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\\\ & \\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe})+ \\epsilon \\end{aligned}$$\n\n::: columns\n::: {.column width=\"45%\"}\n::: proof1\n::: proof-title\nNull $H_0$\n:::\n\n::: proof-cont\n$\\beta_5= \\beta_6 = \\beta_7 =0$\n:::\n:::\n:::\n\n::: {.column width=\"55%\"}\n::: definition\n::: def-title\nAlternative $H_1$\n:::\n\n::: def-cont\n$\\beta_5\\neq0$ and/or $\\beta_6\\neq0$ and/or $\\beta_7\\neq0$\n:::\n:::\n:::\n:::\n\n::: columns\n::: {.column width=\"45%\"}\n::: proof1\n::: proof-title\nNull / Smaller / Reduced model\n:::\n\n::: proof-cont\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\\\& \\beta_3 I(\\text{Asia}) + \\beta_4 I(\\text{Europe}) + \\epsilon \\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"55%\"}\n::: definition\n::: def-title\nAlternative / Larger / Full model\n:::\n\n::: def-cont\n$$\\begin{aligned}LE = &\\beta_0 + \\beta_1 I(\\text{high income}) + \\beta_2 I(\\text{Americas}) + \\beta_3 I(\\text{Asia}) + \\\\ & \\beta_4 I(\\text{Europe}) + \\beta_5 \\cdot I(\\text{high income}) \\cdot I(\\text{Americas}) + \\\\ & \\beta_6\\cdot I(\\text{high income}) \\cdot I(\\text{Asia})+ \\beta_7 \\cdot I(\\text{high income})\\cdot I(\\text{Europe})+ \\epsilon \\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Test interaction between two categorical variables (2/2)\n\n-   Fit the reduced and full model\n\n```{r}\n#| echo: true\nm_int_wr_inc_red = lm(LifeExpectancyYrs ~ income_levels2 + four_regions, \n                   data = gapm_sub)\nm_int_wr_inc_full = lm(LifeExpectancyYrs ~ income_levels2 + four_regions +\n                          income_levels2*four_regions, data = gapm_sub)\n```\n\n-   Display the ANOVA table with F-statistic and p-value\n\n```{r}\nanova(m_int_wr_inc_red, m_int_wr_inc_full) %>% tidy() %>% gt() %>% tab_options(table.font.size = 35) %>% fmt_number(decimals = 3)\n\n# newdata <- data.frame(four_regions = c(\"Africa\", \"Americas\", \"Asia\", \"Europe\"), \n#                       FLR_c = c()) \n# (pred = predict(m_int_wr_full, \n#                 newdata=newdata, \n#                 interval=\"confidence\"))\n```\n\n-   Conclusion: There is not a significant interaction between world region and income level (p = 0.928).\n\n# Learning Objectives\n\n**Last time:**\n\n1.  Define confounders and effect modifiers, and how they interact with the main relationship we model.\n2.  Interpret the interaction component of a model with **a binary categorical covariate and continuous covariate**, and how the main variable's effect changes.\n3.  Interpret the interaction component of a model with **a multi-level categorical covariate and continuous covariate**, and how the main variable's effect changes.\n\n**This time:**\n\n4.  Interpret the interaction component of a model with **two categorical covariates**, and how the main variable's effect changes.\n\n::: lob\n5.  Interpret the interaction component of a model with **two continuous covariates**, and how the main variable's effect changes.\n:::\n\n## Do we think food supply is an effect modifier for female literacy rate?\n\n::: columns\n::: {.column width=\"40%\"}\n-   We can start by visualizing the relationship between life expectancy and female literacy rate *by food supply*\n\n-   Questions of interest: Does the effect of female literacy rate on life expectancy differ depending on food supply?\n\n    -   This is the same as: Is food supply is an effect modifier for female literacy rate? Is food supply an effect modifier of the association between life expectancy and female literacy rate?\n\n-   Let's run an interaction model to see!\n:::\n\n::: {.column width=\"60%\"}\n```{r fig.height=4, fig.width=6, warning=F, fig.align='center'}\n#| echo: false\nm_int_fs = lm(LifeExpectancyYrs ~ FemaleLiteracyRate*FoodSupplykcPPD, data = gapm_sub)\n(mr1_2d = ggPredict(m_int_fs, interactive = T) )\n```\n:::\n:::\n\n## Model with interaction between *two continuous variables*\n\nModel we are fitting:\n\n$$ LE = \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\beta_3 FLR^c \\cdot FS^c + \\epsilon$$\n\n-   $LE$ as life expectancy\n-   $FLR^c$ as the **centered** around the mean female literacy rate (continuous variable)\n-   $FS^c$ as the **centered** around the mean food supply (continuous variable)\n\n```{r}\n#| code-fold: true\n#| code-summary: \"Code to center FLR and FS\"\n#| echo: true\ngapm_sub = gapm_sub %>% \n  mutate(FLR_c = FemaleLiteracyRate - mean(FemaleLiteracyRate), \n         FS_c = FoodSupplykcPPD - mean(FoodSupplykcPPD))\nmean_FS = mean(gapm_sub$FoodSupplykcPPD) %>% round(digits = 0)\nmean_FLR = mean(gapm_sub$FemaleLiteracyRate) %>% round(digits = 2)\n```\n\nIn R:\n\n```{r}\n#| echo: true\n\nm_int_fs = lm(LifeExpectancyYrs ~ FLR_c + FS_c + FLR_c*FS_c, data = gapm_sub)\n```\n\nOR\n\n```{r}\n#| echo: true\n\nm_int_fs = lm(LifeExpectancyYrs ~ FLR_c*FS_c, data = gapm_sub)\n```\n\n## Displaying the regression table and writing fitted regression equation\n\n```{r}\n#| echo: true\ntidy_m_fs = tidy(m_int_fs, conf.int=T) \ntidy_m_fs %>% gt() %>% tab_options(table.font.size = 35) %>% fmt_number(decimals = 5)\n```\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\widehat\\beta_2 FS^c + \\widehat\\beta_3 FLR^c \\cdot FS^c \\\\\n\\widehat{LE} = & `r round(tidy_m_fs$estimate[1],2)` + `r round(tidy_m_fs$estimate[2],2)` \\cdot FLR^c + `r round(tidy_m_fs$estimate[3],2)` \\cdot FS^c - 0.00001 \\cdot FLR^c \\cdot FS^c\n\\end{aligned}$$\n\n## Comparing fitted regression lines for various food supply values\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\widehat\\beta_2 FS^c + \\widehat\\beta_3 FLR^c \\cdot FS^c \\\\\n\\widehat{LE} = & `r round(tidy_m_fs$estimate[1],2)` + `r round(tidy_m_fs$estimate[2],2)` \\cdot FLR^c + `r round(tidy_m_fs$estimate[3],2)` \\cdot FS^c - 0.00001 \\cdot FLR^c \\cdot FS^c\n\\end{aligned}$$\n\nTo identify different lines, we need to pick example values of Food Supply:\n\n::: columns\n::: {.column width=\"33%\"}\n::: FS1\n::: FS1-title\nFood Supply of `r mean_FS -1000` kcal PPD\n:::\n\n::: FS1-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\\\ & \\widehat\\beta_2 \\cdot (-1000) + \\\\ & \\widehat\\beta_3 FLR^c \\cdot (-1000) \\\\\n\\widehat{LE} = & \\big(\\widehat\\beta_0 - 1000 \\widehat\\beta_2 \\big)+ \\\\ & \\big(\\widehat\\beta_1 - 1000 \\widehat\\beta_3  \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"33%\"}\n::: FS2\n::: FS2-title\nFood Supply of `r mean_FS` kcal PPD\n:::\n\n::: FS2-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\\\ & \\widehat\\beta_2 \\cdot 0 + \\\\ & \\widehat\\beta_3 FLR^c \\cdot 0 \\\\\n\\widehat{LE} = & \\big(\\widehat\\beta_0 \\big)+ \\\\ & \\big(\\widehat\\beta_1 \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n:::\n\n::: {.column width=\"33%\"}\n::: FS3\n::: FS3-title\nFood Supply of `r mean_FS + 1000` kcal PPD\n:::\n\n::: FS3-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\\\ & \\widehat\\beta_2 \\cdot 1000 + \\\\ & \\widehat\\beta_3 FLR^c \\cdot 1000 \\\\\n\\widehat{LE} = & \\big(\\widehat\\beta_0 + 1000 \\widehat\\beta_2 \\big)+ \\\\ & \\big(\\widehat\\beta_1 + 1000 \\widehat\\beta_3  \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Poll Everywhere Question??\n\n## Interpretation for interaction between two continuous variables\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR^c + \\widehat\\beta_2 FS^c + \\widehat\\beta_3 FLR^c \\cdot FS^c \\\\\n\\widehat{LE} = & \\bigg[\\widehat\\beta_0 + \\widehat\\beta_2 \\cdot FS^c \\bigg] + \\underbrace{\\bigg[\\widehat\\beta_1 + \\widehat\\beta_3 \\cdot FS^c \\bigg]}_\\text{FLR's effect} FLR \\\\\n\\end{aligned}$$\n\n-   Interpretation:\n\n    -   $\\beta_3$ = mean change in female literacy rate's effect, for every one kcal PPD increase in food supply\n\n-   In summary, the interaction term can be interpreted as \"difference in adjusted female literacy rate effect for every 1 kcal PPD increase in food supply\"\n\n-   It will be helpful to test the interaction to round out this interpretation!!\n\n## Test interaction between two continuous variables\n\n-   We run an F-test for a single coefficients ($\\beta_3$) in the below model (see lesson 9)\n\n$$ LE = \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\beta_3 FLR^c \\cdot FS^c + \\epsilon$$\n\n::: columns\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"40%\"}\n::: proof1\n::: proof-title\nNull $H_0$\n:::\n\n::: proof-cont\n$$\\beta_3=0$$\n:::\n:::\n:::\n\n::: {.column width=\"40%\"}\n::: definition\n::: def-title\nAlternative $H_1$\n:::\n\n::: def-cont\n$$\\beta_3\\neq0$$\n:::\n:::\n:::\n\n::: {.column width=\"10%\"}\n:::\n:::\n\n::: columns\n::: {.column width=\"10%\"}\n:::\n\n::: {.column width=\"40%\"}\n::: proof1\n::: proof-title\nNull / Smaller / Reduced model\n:::\n\n::: proof-cont\n$$ LE = \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\epsilon$$\n:::\n:::\n:::\n\n::: {.column width=\"40%\"}\n::: definition\n::: def-title\nAlternative / Larger / Full model\n:::\n\n::: def-cont\n$$\\begin{aligned}\nLE = & \\beta_0 + \\beta_1 FLR^c + \\beta_2 FS^c + \\\\ & \\beta_3 FLR^c \\cdot FS^c + \\epsilon\n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Test interaction between two continuous variables\n\n-   Fit the reduced and full model\n\n```{r}\n#| echo: true\nm_int_fs_red = lm(LifeExpectancyYrs ~ FLR_c + FS_c, \n                   data = gapm_sub)\nm_int_fs_full = lm(LifeExpectancyYrs ~ FLR_c + FS_c +\n                  FLR_c*FS_c, data = gapm_sub)\n```\n\n \n\n```{r}\n#| code-fold: true\n#| code-summary: \"Display the ANOVA table with F-statistic and p-value\"\n#| echo: true\nanova(m_int_fs_red, m_int_fs_full) %>% tidy() %>% \n  gt() %>% tab_options(table.font.size = 35) %>% fmt_number(decimals = 3)\n```\n\n-   Conclusion: There is not a significant interaction between female literacy rate and food supply (p = 0.945). Food supply is not an effect modifier of the association between female literacy rate and life expectancy.\n\n# Learning Objective\n\n**Bonus learning objective that's not really bonus but just a last minute addition**\n\n6. Report results for a best-fit line (with confidence intervals) at different levels of an effect measure modifier\n\n## How to find the confidence interval for each slope?\n\n- In the example with FS and FLR, we showed:\n\n::: FS3\n::: FS3-title\nBest-fit line for Food Supply of `r mean_FS + 1000` kcal PPD\n:::\n::: FS3-cont\n$$\\begin{aligned} \n\\widehat{LE} = & \\big(\\widehat\\beta_0 + 1000 \\widehat\\beta_2 \\big)+  \\big(\\widehat\\beta_1 + 1000 \\widehat\\beta_3  \\big) FLR^c\n\\end{aligned}$$\n:::\n:::\n\n- Often, we want to report the estimate of the combined coefficients: $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$\n\n  - This allows us to make a statement like: \"At a food supply of 3812 kcal PPD, mean life expectancy increases ($\\widehat\\beta_1 + 1000 \\widehat\\beta_3$) years for every one percent increase in female literacy rate (95% CI: \\_\\_, \\_\\_).\"\n\n \n\n- We can calculate $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$ by using the values of the estimated coefficients\n\n- BUT we always want to have a **95% confidence interval** when we report this combined estimate!!\n\n## Getting a 95% confidence interval requires linear combinations!\n\n- If we want a confidence interval for $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$, then we would use the formula:\n\n$$\\bigg(\\widehat\\beta_1 + 1000 \\widehat\\beta_3 \\bigg) \\pm t^* \\times SE_{(\\beta_1 + 1000 \\beta_3)}$$\n\n- The hard part is figuring out what $SE_{(\\beta_1 + 1000 \\beta_3)}$ (or $\\text{Var}(\\beta_1 + 1000 \\beta_3)$) equals\n\n- We need to go back to variance of linear combinations (BSTA 512/612, EPI 525):\n$$\\text{Var}(aX + bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y) + 2ab\\text{Cov}(X, Y)$$\nor\n$$\\text{Var}(aX - bY) = a^2\\text{Var}(X) + b^2\\text{Var}(Y) - 2ab\\text{Cov}(X, Y)$$\n\n## Reference: calculating $SE_{(\\beta_1 + 1000 \\beta_3)}$ by hand\n\n- A helpful function that returns the variance-covariance matric of all the coefficients in model `m_int_fs`:\n\n::: columns\n::: {.column width=\"70%\"}\n```{r}\n#| echo: true\nvcov(m_int_fs)\n```\n:::\n::: {.column width=\"30%\"}\n$$ \\begin{aligned}\n\\text{Var}(\\beta_1) & = `r round(vcov(m_int_fs)[2,2], 9)` \\\\\n\\text{Var}(\\beta_3) & = `r round(vcov(m_int_fs)[4,4], 9)` \\\\\n\\text{Cov}(\\beta_1, \\beta_3) & = `r round(vcov(m_int_fs)[2,4], 9)` \\\\\n\\end{aligned}$$\n:::\n:::\n\n$$ \\begin{aligned}\n\\text{Var}(\\beta_1 + 1000 \\beta_3) & = \\text{Var}(\\beta_1) + 1000^2\\text{Var}(\\beta_3) + 2000\\text{Cov}(\\beta_1, \\beta_3) \\\\ \n\\text{Var}(\\beta_1 + 1000 \\beta_3) & = `r round(vcov(m_int_fs)[2,2], 9)` + 1000^2 \\times `r round(vcov(m_int_fs)[4,4], 9)` + 2000 \\times `r round(vcov(m_int_fs)[2,4], 9)` \\\\ \n\\text{Var}(\\beta_1 + 1000 \\beta_3) & = `r round(vcov(m_int_fs)[2,2] + 1000^2 * vcov(m_int_fs)[4,4] + 2000 * vcov(m_int_fs)[2,4], 9)` \\\\\nSE_{(\\beta_1 + 1000 \\beta_3)} & = \\sqrt{`r round(vcov(m_int_fs)[2,2] + 1000^2 * vcov(m_int_fs)[4,4] + 2000 * vcov(m_int_fs)[2,4], 9)`} \\\\ \nSE_{(\\beta_1 + 1000 \\beta_3)} & = `r round(sqrt(vcov(m_int_fs)[2,2] + 1000^2 * vcov(m_int_fs)[4,4] + 2000 * vcov(m_int_fs)[2,4]), 9)`\n\\end{aligned}$$\n\n\n## We can use R and `estimable()` to find the estimate and CI\n\nFor $\\widehat\\beta_1 + 1000 \\widehat\\beta_3$:\n\n```{r}\n#| echo: true\n\nlibrary(gmodels)\nm_int_fs %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"FS_c\"        = 0,      # beta2\n                     \"FLR_c:FS_c\"  = 1000),  # beta3\n                   conf.int = 0.95)\n```\n\n```{r}\nm_int_fs_3812 = m_int_fs %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"FS_c\"        = 0,      # beta2\n                     \"FLR_c:FS_c\"  = 1000),  # beta3\n                   conf.int = 0.95)\n```\n\n \n\n**Our conclusion:** At a food supply of 3812 kcal PPD, mean life expectancy increases `r round(m_int_fs_3812$Estimate, 5)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_fs_3812$Lower.CI, 5)`, `r round(m_int_fs_3812$Upper.CI, 5)`).\n\n## Another example: income (binary) and FLR (1/2)\n\n```{r}\n#| echo: true\n\nm_int_inc2 = gapm_sub %>% \n  lm(formula = LifeExpectancyYrs ~ FLR_c*income_levels2)\n```\n\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR + \\widehat\\beta_2 I(\\text{high income}) + \\widehat\\beta_3 FLR \\cdot I(\\text{high income}) \\\\\n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR - 16.65 \\cdot I(\\text{high income}) + 0.228 \\cdot FLR \\cdot I(\\text{high income})\n\\end{aligned}$$\n\n::: columns\n::: column\n::: proof1\n::: proof-title\nFor lower income countries: $I(\\text{high income}) =0$\n:::\n\n::: proof-cont\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR + \\widehat\\beta_2 \\cdot 0 + \\widehat\\beta_3 FLR \\cdot 0 \\\\\n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR - 16.65 \\cdot 0 + \\\\\n& 0.228 \\cdot FLR \\cdot 0 \\\\ \n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR\\\\ \n\\end{aligned}$$\n:::\n:::\n:::\n\n::: column\n::: fact\n::: fact-title\nFor higher income countries: $I(\\text{high income}) =1$\n:::\n\n::: fact-cont\n$$ \\begin{aligned}\n\\widehat{LE} = & \\widehat\\beta_0 + \\widehat\\beta_1 FLR + \\widehat\\beta_2 \\cdot 1 + \\widehat\\beta_3 FLR \\cdot 1 \\\\\n\\widehat{LE} = & 54.85 + 0.156 \\cdot FLR - 16.65 \\cdot 1 + \\\\ & 0.228 \\cdot FLR \\cdot 1 \\\\ \n\\widehat{LE} = & `r 54.85 - 16.65` + `r 0.156 + 0.228` \\cdot FLR\\\\ \n\\end{aligned}$$\n:::\n:::\n:::\n:::\n\n## Another example: income (binary) and FLR (2/2)\n\n\n```{r}\n#| echo: true\n\nm_int_inc2$coefficients # I just need to see the exact names\nm_int_inc2 %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"income_levels2Higher income\" = 0,      # beta2\n                     \"FLR_c:income_levels2Higher income\"  = 1),  # beta3\n                   conf.int = 0.95)\n```\n\n```{r}\nm_int_high_inc = m_int_inc2 %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 1,      # beta1\n                     \"income_levels2Higher income\" = 0,      # beta2\n                     \"FLR_c:income_levels2Higher income\"  = 1),  # beta3\n                   conf.int = 0.95)\n```\n\n \n\n**Our conclusion:** For countries with high income, mean life expectancy increases `r round(m_int_high_inc$Estimate, 3)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_high_inc$Lower.CI, 3)`, `r round(m_int_high_inc$Upper.CI, 3)`).\n\n## If our example had an effect measure modifier\n\n```{r}\nm_int_low_inc = m_int_inc2 %>% estimable(\n                   c(\"(Intercept)\" = 0,      # beta0\n                     \"FLR_c\"       = 0,      # beta1\n                     \"income_levels2Higher income\" = 1,      # beta2\n                     \"FLR_c:income_levels2Higher income\"  = 0),  # beta3\n                   conf.int = 0.95)\n```\n\n- None of our examples had a significant interaction, so it's hard to demonstrate exactly how we would report this\n\n- Let's say, **just for example**, that income had a significant interaction with FLR\n  - How would we report this to an audience??\n  \n- Here's how to report on an interaction/EMM:\n\n  - We found that a country's income status (high or low) is a significant effect measure modifier on female literacy rate (*include p-value for interaction test here*). For countries with high income, mean life expectancy increases `r round(m_int_high_inc$Estimate, 3)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_high_inc$Lower.CI, 3)`, `r round(m_int_high_inc$Upper.CI, 3)`). For countries with low income, mean life expectancy increases `r round(m_int_low_inc$Estimate, 3)` years for every one percent increase in female literacy rate (95% CI: `r round(m_int_low_inc$Lower.CI, 3)`, `r round(m_int_low_inc$Upper.CI, 3)`).\"\n\n# Extra Reference Material\n\n## General interpretation of the interaction term (reference)\n\n$E[Y\\mid X_{1},X_{2} ]=\\beta_0 + \\underbrace{(\\beta_1+\\beta_3X_{2}) }_\\text{$X_{1}$'s effect} X_{1}+ \\underbrace{\\beta_2X_{2}}_\\text{$X_{2}$ held constant}$\\\n${\\color{white}{E[Y\\mid X_{1},X_{2} ]}}=\\beta_0 + \\underbrace{(\\beta_2+\\beta_3X_{1}) }_\\text{$X_{2}$'s effect}X_{2} + \\underbrace{\\beta_1X_{1}}_\\text{$X_{1}$ held constant}$\n\n-   Interpretation:\n\n    -   $\\beta_3$ = mean change in $X_{1}$'s effect, per unit increase in $X_{2}$;\\\n\n    -   [$\\beta_3$]{style=\"color: white\"} = mean change in $X_{2}$'s effect, per unit increase in $X_{1}$;\n\n    -   where the \"$X_{1}$ effect\" equals the change in $E[Y]$ per unit increase in $X_{1}$ with $X_{2}$ held constant, i.e. \"adjusted $X_{1}$ effect\"\n\n-   In summary, the interaction term can be interpreted as \"difference in adjusted $X_1$ (or $X_2$) effect per unit increase in $X_2$ (or $X_1$)\"\n\n## A glimpse at how interactions might be incorporated into model selection {.smaller}\n\n1.  Identify outcome (Y) and primary explanatory (X) variables\n\n2.  Decide which other variables might be important and could be potential confounders. Add these to the model.\n\n    -   This is often done by indentifying variables that previous research deemed important, or researchers believe could be important\n    -   From a statistical perspective, we often include variables that are significantly associated with the outcome (in their respective SLR)\n\n3.  (Optional step) Test 3 way interactions\n\n    -   This makes our model incredibly hard to interpret. Our class will not cover this!!\n    -   We will skip to testing 2 way interactions\n\n4.  Test 2 way interactions\n\n    -   When testing a 2 way interaction, make sure the full and reduced models contain the main effects\n\n    -   First test all the 2 way interactions together using a partial F-test (with $alpha = 0.10$)\n\n        -   If this test not significant, do not test 2-way interactions individually\n        -   If partial F-test is significant, then test each of the 2-way interactions\n\n5.  Remaining main effects - to include of not to include?\n\n    -   For variables that are included in any interactions, they will be automatically included as main effects and thus not checked for confounding\n\n    -   For variables that are not included in any interactions:\n\n        -   Check to see if they are confounders by seeing whether exclusion of the variable(s) changes any of the coefficient of the primary explanatory variable (including interactions) X by more than 10%\n\n            -   If any of X's coefficients change when removing the potential confounder, then keep it in the model\n"},"formats":{"revealjs":{"identifier":{"display-name":"RevealJS","target-format":"revealjs","base-format":"revealjs"},"execute":{"fig-width":10,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":"auto","echo":false,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","html-math-method":"mathjax","slide-level":2,"to":"revealjs","highlight-style":"ayu","output-file":"12_Interactions_02.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":false,"quarto-version":"1.8.25","auto-stretch":true,"title":"Lesson 12: Interactions, Part 2","author":"Nicky Wakim","title-slide-attributes":{"data-background-color":"#213c96"},"date":"02/19/2025","theme":"../simple_NW.scss","chalkboard":true,"slideNumber":true,"showSlideNumber":"all","width":1955,"height":1100,"footer":"Lesson 12: Interactions 2"}}},"projectFormats":["html"]}